var learnDashProPanel=jQuery((function($){var proPanelTable,containerType,widgetObjects={},currentFilters={type:null,id:null,courseStatus:null,search:null,groups:"",courses:"",users:"",time_start:"",time_end:"",dateStart:"",dateEnd:"",reporting_pager:{},activity_pager:{}},selectedUserIds=[];function loadTemplate(element,template,args){if(function(element){if(element.parents(".postbox").find("loading").length)return;element.parents(".postbox").find("h2.hndle").append('<img src="'+ld_propanel_settings.spinner_admin_img+'" class="loading">')}(element),("activity"==template||"activity_rows"==template)&&(void 0===args&&(args={}),jQuery("#dashboard-widgets").length)){var per_page=jQuery("select#ld-propanel-pagesize").val();void 0!==per_page&&(args.per_page=per_page)}$.when($.ajax({url:ld_propanel_settings.ajaxurl,method:"get",dataType:"json",data:{action:"learndash_propanel_template",template:template,filters:currentFilters,container_type:containerType,args:args,nonce:ld_propanel_settings.nonce,lang:ld_propanel_settings.lang}})).done((function(response){!function(element){setTimeout((function(){element.parents(".postbox").find(".loading").remove()}),500)}(element),response.hasOwnProperty("success")&&(void 0!==response.data.output.rows_html?element.html(response.data.output.rows_html):void 0!==response.data.output&&element.html(response.data.output),$(document).trigger("proPanel.templateLoaded",[template]),$(window).trigger("resize"))}))}function loadReportingTable(){if(void 0!==widgetObjects.reporting){proPanelTable=widgetObjects.reporting.find(".tablesorter");jQuery("select#ld-propanel-pagesize").val(),jQuery("select#ld-propanel-pagesize").val();$.when($.ajax({url:ld_propanel_settings.ajaxurl,method:"get",dataType:"json",data:{action:"learndash_propanel_reporting_get_result_rows",nonce:ld_propanel_settings.nonce,filters:currentFilters,container_type:containerType,lang:ld_propanel_settings.lang}})).done((function(response){void 0!==response.rows_html&&(proPanelTable.find("tbody").html(response.rows_html),void 0===widgetObjects.filtering&&(proPanelTable.find("thead th.ld-propanel-reporting-col-checkbox").hide(),proPanelTable.find("tbody td.ld-propanel-reporting-col-checkbox").hide())),$(window).trigger("resize"),void 0!==response.pager?(currentFilters.reporting_pager=response.pager,$(".ld-propanel-widget-reporting .pager .ld-propanel-reporting-pager-info").show(),$(".ld-propanel-widget-reporting .pager .ld-propanel-reporting-pager-info span.pagedisplay span.current_page").html(response.pager.current_page),$(".ld-propanel-widget-reporting .pager .ld-propanel-reporting-pager-info span.pagedisplay span.total_pages").html(response.pager.total_pages),$(".ld-propanel-widget-reporting .pager .ld-propanel-reporting-pager-info span.pagedisplay span.total_items").html(response.pager.total_items),1==parseInt(response.pager.current_page)?($(".ld-propanel-widget-reporting .pager .ld-propanel-reporting-pager-info button.first").attr("disabled",!0),$(".ld-propanel-widget-reporting .pager .ld-propanel-reporting-pager-info button.prev").attr("disabled",!0)):($(".ld-propanel-widget-reporting .pager .ld-propanel-reporting-pager-info button.first").attr("disabled",!1),$(".ld-propanel-widget-reporting .pager .ld-propanel-reporting-pager-info button.prev").attr("disabled",!1)),parseInt(response.pager.current_page)==parseInt(response.pager.total_pages)?($(".ld-propanel-widget-reporting .pager .ld-propanel-reporting-pager-info button.last").attr("disabled",!0),$(".ld-propanel-widget-reporting .pager .ld-propanel-reporting-pager-info button.next").attr("disabled",!0)):($(".ld-propanel-widget-reporting .pager .ld-propanel-reporting-pager-info button.last").attr("disabled",!1),$(".ld-propanel-widget-reporting .pager .ld-propanel-reporting-pager-info button.next").attr("disabled",!1))):(currentFilters.reporting_pager={},$(".ld-propanel-widget-reporting .pager .ld-propanel-reporting-pager-info span.pagedisplay span.current_page").html("0"),$(".ld-propanel-widget-reporting .pager .ld-propanel-reporting-pager-info span.pagedisplay span.total_pages").html("0"),$(".ld-propanel-widget-reporting .pager .ld-propanel-reporting-pager-info span.pagedisplay span.total_items").html("0"),$(".ld-propanel-widget-reporting .pager .ld-propanel-reporting-pager-info").hide()),updateSelectedCount(),maybeHideEmailBox(),$(document).trigger("proPanel.reportingTableUpdated")}))}}function ajaxGetSelect2Data(filter_key){return{url:ld_propanel_settings.ajaxurl,dataType:"json",method:"get",delay:1e3,cache:!0,data:function(params){return{action:"learndash_propanel_filters_search",filter_key:filter_key,filters:currentFilters,search:params.term||"",page:params.page||1,nonce:ld_propanel_settings.nonce,lang:ld_propanel_settings.lang}},processResults:function(response,params){return params.page=params.page||1,{results:response.data.items,pagination:{more:10*params.page<response.data.total}}}}}function handleSelectedUsers(e){if(void 0!==e){if("user"==currentFilters.type&&(selectedUserIds=[]).push($(".user.select2").val()),"course"==currentFilters.type||"group"==currentFilters.type){var current_checkbox=e.currentTarget,user_id=$(current_checkbox).attr("data-user-id"),user_id_checked=!1;if($(e.currentTarget).is(":checked")){user_id_checked=!0;proPanelTable.find('input.ld-propanel-report-checkbox[data-user-id="'+user_id+'"]').attr("checked",user_id_checked),selectedUserIds.push(user_id)}else{user_id_checked=!1;proPanelTable.find('input.ld-propanel-report-checkbox[data-user-id="'+user_id+'"]').attr("checked",user_id_checked),selectedUserIds.splice($.inArray(user_id,selectedUserIds),1)}if(selectedUserIds.length){var selectedUserIds_unique=[];$.each(selectedUserIds,(function(i,el){-1===$.inArray(el,selectedUserIds_unique)&&selectedUserIds_unique.push(el)})),selectedUserIds=selectedUserIds_unique}}$(document).trigger("proPanel.setSelectedUsers")}}function handleSelectedAllUsers(e){if(void 0!==e){var allchecked=jQuery(e.currentTarget).prop("checked");proPanelTable.find("tbody input.ld-propanel-report-checkbox").each((function(idx,cb){$(cb).attr("checked",allchecked).trigger("change")}))}}function updateSelectedAll(){proPanelTable.find("tbody input.ld-propanel-report-checkbox").length?(proPanelTable.find("thead input.ld-propanel-report-checkbox").show(),proPanelTable.find("tbody input.ld-propanel-report-checkbox:checkbox:not(:checked)").length?proPanelTable.find("thead input.ld-propanel-report-checkbox").attr("checked",!1):proPanelTable.find("thead input.ld-propanel-report-checkbox").attr("checked",!0)):proPanelTable.find("thead input.ld-propanel-report-checkbox").hide()}function setSelectedUsers(){"user"==currentFilters.type&&(selectedUserIds=[]).push($(".user.select2").val()),"course"!=currentFilters.type&&"group"!=currentFilters.type||selectedUserIds.length&&$.each(selectedUserIds,(function(user_idx,user_id){proPanelTable.find('input.ld-propanel-report-checkbox[data-user-id="'+user_id+'"]').attr("checked",!0)}))}function showReportingButton(){void 0!==widgetObjects.reporting&&(void 0!==widgetObjects.activity?jQuery("p.download-button-wrap",widgetObjects.reporting).hide():jQuery("p.download-button-wrap",widgetObjects.reporting).show())}function maybeHideEmailBox(){void 0!==currentFilters.reporting_pager.total_items&&parseInt(currentFilters.reporting_pager.total_items)>0?($(".email .no-results").hide(),$(".email .results").show()):($(".email .no-results").show(),$(".email .results").hide())}function updateSelectedCount(){if("user"==currentFilters.type)$("a.email-toggle").find("span.count").html("");else{var selected_user_count=0;selectedUserIds.length&&(selected_user_count=selectedUserIds.length),selected_user_count>0?$("a.email-toggle").find("span.count").html(" ("+selected_user_count+")"):$("a.email-toggle").find("span.count").html("")}}function sendEmailUsers(){var emailContainer,subject,message,sending,sent,sendButton;if(void 0!==widgetObjects.filtering){if(subject=(emailContainer=$("#email",widgetObjects.filtering)).find(".subject").val(),message=emailContainer.find(".message").val(),!selectedUserIds)return;sending=emailContainer.find(".sending"),sent=emailContainer.find(".sent"),sendButton=emailContainer.find("#propanel-send-email"),sending.show(),sendButton.prop("disabled",!0),$.when($.ajax({url:ld_propanel_settings.ajaxurl,method:"post",dataType:"json",data:{action:"learndash_propanel_email_users",user_ids:selectedUserIds.join(),subject:subject,message:message,filters:currentFilters,nonce:ld_propanel_settings.nonce,is_debug:ld_propanel_settings.is_debug,lang:ld_propanel_settings.lang}})).done((function(response){response.success?(void 0!==response.data.message&&""!=response.data.message&&sent.html(response.data.message),sent.fadeIn(),void 0!==response.data.debug&&""!==response.data.debug&&ld_propanel_settings.is_debug&&alert(response.data.debug),setTimeout((function(){sent.fadeOut(),sent.html(""),sendButton.prop("disabled",!1)}),3e3)):alert(response.data.message)}))}}function resetEmailUsers(){void 0!==widgetObjects.filtering&&(emailContainer=$("#email",widgetObjects.filtering),emailContainer.find(".subject").val(""),emailContainer.find(".message").val(""),$("#propanel-send-email").prop("disabled",!0),$("#propanel-reset-email").prop("disabled",!0))}function loadActivity(){$(document.activeElement).hasClass("course-status")||void 0!==widgetObjects.activity&&loadTemplate(widgetObjects.activity,"activity_rows")}function processActivityPagination(event){event.preventDefault(),template_args={};var thisPagination=$(this);template_args.paged=thisPagination.attr("data-page"),void 0!==widgetObjects.activity&&loadTemplate(widgetObjects.activity,"activity_rows",template_args)}function getProgessChartsData(event){$(document.activeElement).hasClass("course-status")||(void 0!==widgetObjects["progress-chart"]&&loadTemplate(widgetObjects["progress-chart"],"progress-chart-data"),$.when($.ajax({url:ld_propanel_settings.ajaxurl,method:"get",dataType:"json",data:{action:"learndash_propanel_get_progress_charts_data",filters:currentFilters,nonce:ld_propanel_settings.nonce,lang:ld_propanel_settings.lang}})).done((function(response){response&&response.hasOwnProperty("success")&&function(data){void 0!==data.all_progress&&function(chart_data){"undefined"!=typeof proPanelProgressAllChart&&proPanelProgressAllChart.destroy();if(void 0!==chart_data.data&&void 0!==chart_data.data.datasets&&chart_data.data.datasets.length>0){jQuery("#proPanelProgressAllDefaultMessage").hide();var ctxProPanelProgressAll=document.getElementById("proPanelProgressAll").getContext("2d");if(void 0!==ctxProPanelProgressAll){var progressAllData={labels:[],datasets:[]};void 0!==chart_data.data.labels&&(progressAllData.labels=chart_data.data.labels),void 0!==chart_data.data.datasets&&(progressAllData.datasets=chart_data.data.datasets);var progressAllOptions={};void 0!==chart_data.options&&(progressAllOptions=chart_data.options),window.proPanelProgressAllChart=new Chart(ctxProPanelProgressAll,{type:"doughnut",data:progressAllData,options:progressAllOptions})}}else jQuery("#proPanelProgressAllDefaultMessage").show(),jQuery("#proPanelProgressAll").hide(),jQuery("#proPanelProgressAll").css("height","0"),jQuery("#proPanelProgressAll").css("width","0")}(data.all_progress);void 0!==data.all_percentages&&function(chart_data){"undefined"!=typeof proPanelProgressAllPercentagesChart&&proPanelProgressAllPercentagesChart.destroy();if(void 0!==chart_data.data.datasets&&chart_data.data.datasets.length>0){jQuery("#proPanelProgressInMotionDefaultMessage").hide();var ctxProPanelProgressInMotion=document.getElementById("proPanelProgressInMotion").getContext("2d");if(void 0!==ctxProPanelProgressInMotion){var progressInMotionData={labels:[],datasets:[]};void 0!==chart_data.data.labels&&(progressInMotionData.labels=chart_data.data.labels),void 0!==chart_data.data.datasets&&(progressInMotionData.datasets=chart_data.data.datasets);var progressInMotionOptions={};void 0!==chart_data.options&&(progressInMotionOptions=chart_data.options),window.proPanelProgressAllPercentagesChart=new Chart(ctxProPanelProgressInMotion,{type:"doughnut",data:progressInMotionData,options:progressInMotionOptions})}}else jQuery("#proPanelProgressInMotionDefaultMessage").show(),jQuery("#proPanelProgressInMotion").hide(),jQuery("#proPanelProgressInMotion").css("height","0"),jQuery("#proPanelProgressInMotion").css("width","0")}(data.all_percentages)}(response.data)})))}function downloadReporting(e){e.stopImmediatePropagation();var data_template=$(e.target).attr("data-template"),data_slug=$(e.target).attr("data-slug"),data_nonce=$(e.target).attr("data-nonce"),updateElement=e.target;void 0!==data_template&&(jQuery(e.target).prop("disabled",!0),loadActivityTemplate(data_template,{init:1,nonce:data_nonce,slug:data_slug,filters:currentFilters},updateElement))}function filterReporting(e){if(void 0!==e&&e.stopImmediatePropagation(),selectedUserIds=[],updateSelectedCount(),void 0!==widgetObjects.reporting&&(jQuery('.filter-selection.filter-section-date input[name="filter-date-start"]').length?currentFilters.time_start=jQuery('.filter-selection.filter-section-date input[name="filter-date-start"]').val():currentFilters.time_start="",jQuery('.filter-selection.filter-section-date input[name="filter-date-end"]').length?currentFilters.time_end=jQuery('.filter-selection.filter-section-date input[name="filter-date-end"]').val():currentFilters.time_end=""),""!==currentFilters.groups?(currentFilters.type="group",currentFilters.id=currentFilters.groups):""!==currentFilters.users?(currentFilters.type="user",currentFilters.id=currentFilters.users):""!==currentFilters.course&&(currentFilters.type="course",currentFilters.id=currentFilters.courses),void 0!==widgetObjects.reporting){var reportingContainer=$(".propanel-reporting",widgetObjects.reporting);"group"==currentFilters.type?loadTemplate(reportingContainer,"group-reporting"):"course"==currentFilters.type?loadTemplate(reportingContainer,"course-reporting"):"user"==currentFilters.type&&loadTemplate(reportingContainer,"user-reporting")}currentFilters.reporting_pager.current_page=1,$(document).trigger("proPanel.filterChanged")}function pagerReporting(e){currentFilters.reporting_pager.current_page=parseInt(currentFilters.reporting_pager.current_page),currentFilters.reporting_pager.total_pages=parseInt(currentFilters.reporting_pager.total_pages);var pager_el=e.currentTarget,pager_change=!1;$(pager_el).hasClass("next")?currentFilters.reporting_pager.current_page<currentFilters.reporting_pager.total_pages&&(pager_change=!0,currentFilters.reporting_pager.current_page=currentFilters.reporting_pager.current_page+1):$(pager_el).hasClass("prev")?currentFilters.reporting_pager.current_page>1&&(pager_change=!0,currentFilters.reporting_pager.current_page=currentFilters.reporting_pager.current_page-1):$(pager_el).hasClass("first")?currentFilters.reporting_pager.current_page>1&&(pager_change=!0,currentFilters.reporting_pager.current_page=1):$(pager_el).hasClass("last")&&currentFilters.reporting_pager.current_page<currentFilters.reporting_pager.total_pages&&(pager_change=!0,currentFilters.reporting_pager.current_page=currentFilters.reporting_pager.total_pages),1==pager_change&&loadReportingTable()}function resetReporting(e){e.stopImmediatePropagation(),window.location.reload(!1)}function downloadActivity(e){e.stopImmediatePropagation();var data_template=$(e.target).attr("data-template"),data_slug=$(e.target).attr("data-slug"),data_nonce=$(e.target).attr("data-nonce"),updateElement=e.target;if(!jQuery("#dashboard-widgets").length){var activityContainer=$(e.currentTarget).parents("div.learndash-propanel-activity");if(void 0!==activityContainer){var filters=$(activityContainer).data("filters");void 0!==filters&&""!=filters&&(currentFilters=filters)}}void 0!==data_template&&(jQuery(updateElement).prop("disabled",!0),loadActivityTemplate(data_template,{init:1,nonce:data_nonce,slug:data_slug,filters:currentFilters},updateElement))}function loadActivityTemplate(template,args,updateElement){$.when($.ajax({url:ld_propanel_settings.ajaxurl,method:"get",dataType:"json",data:{action:"learndash_propanel_template",template:template,args:args,nonce:ld_propanel_settings.nonce,lang:ld_propanel_settings.lang}})).done((function(response){if(void 0!==response&&void 0!==response.data.output.rows_html){var reply_data=response.data.output.rows_html;$(window).trigger("resize");var total_count=0;void 0!==reply_data.data.total_count&&(total_count=parseInt(reply_data.data.total_count));var result_count=0;if(void 0!==reply_data.data.result_count&&(result_count=parseInt(reply_data.data.result_count)),result_count<total_count){if(void 0!==updateElement&&jQuery(updateElement).length&&void 0!==reply_data.data.progress_percent){var progress_percent=parseInt(reply_data.data.progress_percent);jQuery("span.status",updateElement).html(" "+progress_percent+"%")}loadActivityTemplate(template,reply_data.data,updateElement)}else jQuery(updateElement).prop("disabled",!1),jQuery("span.status",updateElement).html(""),void 0!==reply_data.data.report_download_link&&""!=reply_data.data.report_download_link&&(window.location.href=reply_data.data.report_download_link)}}))}function reporting_init_search(){if(void 0!==widgetObjects.reporting&&jQuery("input.tablesorter-search",widgetObjects.reporting).length){var search_interval_ref,search_value="";jQuery("input.tablesorter-search",widgetObjects.reporting).focus((function(){var search_el=this;search_value=jQuery(search_el).val(),""!=search_interval_ref&&clearInterval(search_interval_ref),search_interval_ref=setInterval((function(){""==(search_value=jQuery(search_el).val())&&search_value!=currentFilters.search?(currentFilters.search=search_value,currentFilters.current_page=1,loadReportingTable()):(search_value.length>=3&&search_value!=currentFilters.search&&(currentFilters.search=search_value,currentFilters.current_page=1,loadReportingTable()),jQuery("input.tablesorter-search",widgetObjects.reporting).is(":focus")||clearInterval(search_interval_ref))}),200)}))}}!function(){var is_debug=function(name){for(var hash,vars={},hashes=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<hashes.length;i++)hash=hashes[i].split("="),vars[hash[0]]=hash[1];if(void 0!==vars[name])return vars[name]}("LD_DEBUG");void 0!==is_debug&&""!=is_debug&&(ld_propanel_settings.is_debug=is_debug);$(window).resize((function(){var widget_width;void 0!==widgetObjects.reporting&&((widget_width=widgetObjects.reporting.width())<350?(widgetObjects.reporting.find(".ld-propanel-reporting-pager-info").addClass("ld-propanel-full-width"),widgetObjects.reporting.find(".search-wrap").addClass("ld-propanel-full-width")):(widgetObjects.reporting.find(".ld-propanel-reporting-pager-info").removeClass("ld-propanel-full-width"),widgetObjects.reporting.find(".search-wrap").removeClass("ld-propanel-full-width")),widgetObjects.reporting.find("table.ld-propanel-reporting-table-groups-widget").length&&(widget_width<350?widgetObjects.reporting.find("table tbody td.ld-propanel-reporting-col-course").length&&widgetObjects.reporting.find("td.ld-propanel-reporting-col-progress").length&&(widgetObjects.reporting.find("table thead th.ld-propanel-reporting-col-progress").hide(),widgetObjects.reporting.find("table tbody td.ld-propanel-reporting-col-progress").hide(),widgetObjects.reporting.find("table tbody td.ld-propanel-reporting-col-course div.ld-propanel-reporting-col-progress").length?widgetObjects.reporting.find("table tbody td.ld-propanel-reporting-col-course div.ld-propanel-reporting-col-progress").show():widgetObjects.reporting.find("table tbody tr").each((function(){var tr=$(this);if(!$(tr).find("td.ld-propanel-reporting-col-course div.ld-propanel-reporting-col-progress").length&&$(tr).find("td.ld-propanel-reporting-col-progress").length){var td_progress_html=$(tr).find("td.ld-propanel-reporting-col-progress").html();void 0!==td_progress_html&&($(tr).find("td.ld-propanel-reporting-col-course").append('<div class="ld-propanel-reporting-col-progress" style="display:none; margin-top: 20px;">'+td_progress_html+"</div>"),$(tr).find("td.ld-propanel-reporting-col-course div.ld-propanel-reporting-col-progress").show())}}))):(widgetObjects.reporting.find("table thead th.ld-propanel-reporting-col-progress").show(),widgetObjects.reporting.find("table tbody td.ld-propanel-reporting-col-progress").show(),widgetObjects.reporting.find("table tbody td.ld-propanel-reporting-col-course div.ld-propanel-reporting-col-progress").hide())),widgetObjects.reporting.find("table.ld-propanel-reporting-table-courses-widget").length&&(widget_width<350?widgetObjects.reporting.find("table tbody td.ld-propanel-reporting-col-user").length&&widgetObjects.reporting.find("td.ld-propanel-reporting-col-progress").length&&(widgetObjects.reporting.find("table thead th.ld-propanel-reporting-col-progress").hide(),widgetObjects.reporting.find("table tbody td.ld-propanel-reporting-col-progress").hide(),widgetObjects.reporting.find("table tbody td.ld-propanel-reporting-col-user div.ld-propanel-reporting-col-progress").length?widgetObjects.reporting.find("table tbody td.ld-propanel-reporting-col-user div.ld-propanel-reporting-col-progress").show():widgetObjects.reporting.find("table tbody tr").each((function(){var tr=$(this);if(!$(tr).find("td.ld-propanel-reporting-col-course div.ld-propanel-reporting-col-progress").length&&$(tr).find("td.ld-propanel-reporting-col-progress").length){var td_progress_html=$(tr).find("td.ld-propanel-reporting-col-progress").html();void 0!==td_progress_html&&($(tr).find("td.ld-propanel-reporting-col-user").append('<div class="ld-propanel-reporting-col-progress" style="display:none; margin-top: 20px;">'+td_progress_html+"</div>"),$(tr).find("td.ld-propanel-reporting-col-user div.ld-propanel-reporting-col-progress").show())}}))):(widgetObjects.reporting.find("table thead th.ld-propanel-reporting-col-progress").show(),widgetObjects.reporting.find("table tbody td.ld-propanel-reporting-col-progress").show(),widgetObjects.reporting.find("table tbody td.ld-propanel-reporting-col-user div.ld-propanel-reporting-col-progress").hide())),widgetObjects.reporting.find("table.ld-propanel-reporting-table-users-widget").length&&(widget_width<350?widgetObjects.reporting.find("table tbody td.ld-propanel-reporting-col-course").length&&widgetObjects.reporting.find("td.ld-propanel-reporting-col-progress").length&&(widgetObjects.reporting.find("table thead th.ld-propanel-reporting-col-progress").hide(),widgetObjects.reporting.find("table tbody td.ld-propanel-reporting-col-progress").hide(),widgetObjects.reporting.find("table tbody td.ld-propanel-reporting-col-course div.ld-propanel-reporting-col-progress").length?widgetObjects.reporting.find("table tbody td.ld-propanel-reporting-col-course div.ld-propanel-reporting-col-progress").show():widgetObjects.reporting.find("table tbody tr").each((function(){var tr=$(this);if(!$(tr).find("td.ld-propanel-reporting-col-course div.ld-propanel-reporting-col-progress").length&&$(tr).find("td.ld-propanel-reporting-col-progress").length){var td_progress_html=$(tr).find("td.ld-propanel-reporting-col-progress").html();void 0!==td_progress_html&&($(tr).find("td.ld-propanel-reporting-col-course").append('<div class="ld-propanel-reporting-col-progress" style="display:none; margin-top: 20px;">'+td_progress_html+"</div>"),$(tr).find("td.ld-propanel-reporting-col-course div.ld-propanel-reporting-col-progress").show())}}))):(widgetObjects.reporting.find("table thead th.ld-propanel-reporting-col-progress").show(),widgetObjects.reporting.find("table tbody td.ld-propanel-reporting-col-progress").show(),widgetObjects.reporting.find("table tbody td.ld-propanel-reporting-col-course div.ld-propanel-reporting-col-progress").hide()))),void 0!==widgetObjects.activity&&((widget_width=widgetObjects.activity.width())<350?(widgetObjects.activity.find(".report-pagination").addClass("ld-propanel-full-width"),widgetObjects.activity.find(".report-exports").addClass("ld-propanel-full-width")):(widgetObjects.activity.find(".report-pagination").removeClass("ld-propanel-full-width"),widgetObjects.activity.find(".report-exports").removeClass("ld-propanel-full-width")))})),void $(document).trigger("resize"),$(document).trigger("proPanel.loadWidgets"),$(document).on("proPanel.templateLoaded",(function(event,template){"filtering"==template&&(widgetObjects.filtering.on("click tap",".section-toggle",(function(){var $showThis=$(this).attr("href");return $(this).toggleClass("active").siblings().removeClass("active"),$(""+$showThis).toggleClass("display").siblings().removeClass("display"),!1})),$("select#ld-propanel-pagesize").length&&(void 0===currentFilters.reporting_pager&&(currentFilters.reporting_pager=[]),currentFilters.reporting_pager.per_page=jQuery("select#ld-propanel-pagesize option:checked").val(),void 0===currentFilters.reporting_pager.per_page&&(currentFilters.reporting_pager.per_page=$("select#ld-propanel-pagesize").find("option:first-child").val()),void 0===currentFilters.reporting_pager.current_page&&(currentFilters.reporting_pager.current_page=1),$(document).on("change","select#ld-propanel-pagesize",(function(){currentFilters.reporting_pager.per_page=$(this).val()}))),$(".filter-selection select",widgetObjects.filtering).each((function(){var filter_select=$(this),filter_section=$(filter_select).parent(".filter-selection"),filter_key=$(filter_section).data("filter-key");void 0!==filter_key&&""!=filter_key&&$(filter_select).select2({theme:"ld_propanel",dir:window.isRtl?"rtl":"",ajax:ajaxGetSelect2Data(filter_key),containerCssClass:"filter-"+filter_key+"-select2"}),$(filter_select).change((function(){$(this);var filter_val=$(this).val();null==filter_val&&($(this).val(""),filter_val="");var filter_section=$(this).parent(".filter-selection"),filter_key=$(filter_section).data("filter-key");void 0!==filter_key&&""!=filter_key&&(currentFilters[filter_key]=filter_val)}))})),function(){void 0!==ld_propanel_settings.flatpickr_locale.months&&(void 0!==ld_propanel_settings.flatpickr_locale.months.longhand&&(flatpickr.l10ns.default.months.longhand=ld_propanel_settings.flatpickr_locale.months.longhand),void 0!==ld_propanel_settings.flatpickr_locale.months.shorthand&&(flatpickr.l10ns.default.months.shorthand=ld_propanel_settings.flatpickr_locale.months.shorthand));void 0!==ld_propanel_settings.flatpickr_locale.weekdays&&(void 0!==ld_propanel_settings.flatpickr_locale.weekdays.longhand&&(flatpickr.l10ns.default.weekdays.longhand=ld_propanel_settings.flatpickr_locale.weekdays.longhand),void 0!==ld_propanel_settings.flatpickr_locale.weekdays.shorthand&&(flatpickr.l10ns.default.weekdays.shorthand=ld_propanel_settings.flatpickr_locale.weekdays.shorthand));void 0!==ld_propanel_settings.flatpickr_locale.time_24hr&&(ld_propanel_settings.flatpickr_locale.time_24hr?flatpickr.l10ns.default.time_24hr=!0:flatpickr.l10ns.default.time_24hr=!1);void 0!==ld_propanel_settings.flatpickr_locale.hourAriaLabel&&(flatpickr.l10ns.default.hourAriaLabel=ld_propanel_settings.flatpickr_locale.hourAriaLabel);void 0!==ld_propanel_settings.flatpickr_locale.minuteAriaLabel&&(flatpickr.l10ns.default.minuteAriaLabel=ld_propanel_settings.flatpickr_locale.minuteAriaLabel);void 0!==ld_propanel_settings.flatpickr_locale.monthAriaLabel&&(flatpickr.l10ns.default.monthAriaLabel=ld_propanel_settings.flatpickr_locale.monthAriaLabel);void 0!==ld_propanel_settings.flatpickr_locale.rangeSeparator&&(flatpickr.l10ns.default.rangeSeparator=ld_propanel_settings.flatpickr_locale.rangeSeparator);void 0!==ld_propanel_settings.flatpickr_locale.scrollTitle&&(flatpickr.l10ns.default.scrollTitle=ld_propanel_settings.flatpickr_locale.scrollTitle);void 0!==ld_propanel_settings.flatpickr_locale.toggleTitle&&(flatpickr.l10ns.default.toggleTitle=ld_propanel_settings.flatpickr_locale.toggleTitle);void 0!==ld_propanel_settings.flatpickr_locale.weekAbbreviation&&(flatpickr.l10ns.default.weekAbbreviation=ld_propanel_settings.flatpickr_locale.weekAbbreviation);void 0!==ld_propanel_settings.flatpickr_locale.yearAriaLabel&&(flatpickr.l10ns.default.yearAriaLabel=ld_propanel_settings.flatpickr_locale.yearAriaLabel);flatpickr(".filter-selection.filter-section-date .ld_filter_section_date",{allowInput:!0,enableTime:!0,dateFormat:"Y-m-d H:i",altInput:!0,altFormat:ld_propanel_settings.flatpickr_date_time_format,maxDate:(new Date).fp_incr(1)})}(),void 0!==widgetObjects.filtering&&$("#email",widgetObjects.filtering).on("keyup",".subject, .message",(function(){var subject=$("#email .subject",widgetObjects.filtering).val(),message=$("#email .message",widgetObjects.filtering).val(),sendButton=$("#propanel-send-email"),resetButton=$("#propanel-reset-email");""==subject||""==message?(sendButton.prop("disabled",!0),resetButton.prop("disabled",!0)):(sendButton.prop("disabled",!1),resetButton.prop("disabled",!1))})),maybeHideEmailBox(),widgetObjects.filtering.on("click","button.filter",filterReporting),widgetObjects.filtering.on("click tap","#propanel-send-email",sendEmailUsers),widgetObjects.filtering.on("click tap","#propanel-reset-email",resetEmailUsers),widgetObjects.filtering.on("click","button.reset",resetReporting)),"reporting"==template&&($(document).on("proPanel.setSelectedUsers",updateSelectedCount),$(document).on("proPanel.setSelectedUsers",updateSelectedAll),$(document).on("click",".ld-propanel-widget-reporting .ld-propanel-reporting-pager-info button",pagerReporting),$(document).on("click",".ld-propanel-widget-reporting button.reporting-download",downloadReporting)),"course-reporting"==template?(loadReportingTable(),setSelectedUsers(),showReportingButton(),proPanelTable.on("change","tbody input.ld-propanel-report-checkbox:checkbox",handleSelectedUsers),proPanelTable.on("change","thead input.ld-propanel-report-checkbox:checkbox",handleSelectedAllUsers),$(document).on("proPanel.reportingTableUpdated",setSelectedUsers),$(document).on("proPanel.reportingTableUpdated",updateSelectedAll),$(document).on("proPanel.reportingTableUpdated",reporting_init_search)):"user-reporting"==template?(loadReportingTable(),setSelectedUsers(),showReportingButton(),$(document).on("proPanel.reportingTableUpdated",setSelectedUsers),$(document).on("proPanel.reportingTableUpdated",reporting_init_search)):"group-reporting"==template&&(loadReportingTable(),setSelectedUsers(),showReportingButton(),proPanelTable.on("change","tbody input.ld-propanel-report-checkbox:checkbox",handleSelectedUsers),proPanelTable.on("change","thead input.ld-propanel-report-checkbox:checkbox",handleSelectedAllUsers),$(document).on("proPanel.reportingTableUpdated",setSelectedUsers),$(document).on("proPanel.reportingTableUpdated",updateSelectedAll),$(document).on("proPanel.reportingTableUpdated",reporting_init_search)),"activity"==template&&$(document).on("proPanel.filterChanged",loadActivity),"activity_rows"!=template&&"activity"!=template||($(".report-pagination .ld-propanel-reporting-pager-info > button",widgetObjects.activity).on("click",processActivityPagination),$(document).on("click","button.download-activity",downloadActivity)),"progress-chart"==template&&$(document).on("proPanel.filterChanged",getProgessChartsData)})),widgetElements=$(".ld-propanel-widget"),$.each(widgetElements,(function(){var widget_id=$(this).data("ld-widget-type");widgetObjects[widget_id]=$(this)})),$.each(widgetObjects,(function(){var widget_id=$(this).data("ld-widget-type");if(void 0===widgetObjects.filtering){var filters=$(this).data("filters");if(void 0!==filters&&""!=filters)for(var filter_key in currentFilters)void 0!==filters[filter_key]&&""!=filters[filter_key]&&("reporting_pager"==filter_key?void 0===widgetObjects.filtering&&(currentFilters[filter_key]=filters[filter_key]):currentFilters[filter_key]=filters[filter_key])}loadTemplate(widgetObjects[widget_id],widget_id)})),void(Object.keys(widgetObjects).length&&void 0===currentFilters.reporting_pager.per_page&&(currentFilters.reporting_pager.per_page=ld_propanel_settings.default_per_page,currentFilters.reporting_pager.current_page=1)),void(""!=containerType&&null!=containerType||(containerType=$("#learndash-propanel-reporting").length&&$("#learndash-propanel-reporting").hasClass("single-view")?"full":"widget")),void 0===widgetObjects.filtering&&void 0!==currentFilters&&(void 0!==widgetObjects.reporting&&(""!=currentFilters.id&&""!=currentFilters.type||delete widgetObjects.reporting),void 0!==widgetObjects["progress-chart"]&&(""!=currentFilters.id&&""!=currentFilters.type||delete widgetObjects["progress-chart"],$(document).on("proPanel.filterChanged",getProgessChartsData)),filterReporting());var widgetElements}()}));jQuery(document).ready((function(){jQuery(".ld-propanel-widget-activity").on("click","a.user_statistic",(function(e){e.preventDefault();var refId=jQuery(this).data("ref_id"),quizId=jQuery(this).data("quiz_id"),userId=jQuery(this).data("user_id"),statistic_nonce=jQuery(this).data("statistic_nonce"),post_data={action:"wp_pro_quiz_admin_ajax_statistic_load_user",func:"statisticLoadUser",data:{quizId:quizId,userId:userId,refId:refId,statistic_nonce:statistic_nonce,avg:0,lang:ld_propanel_settings.lang}};jQuery("#wpProQuiz_user_overlay, #wpProQuiz_loadUserData").show();var content=jQuery("#wpProQuiz_user_content").hide();jQuery.when(jQuery.ajax({type:"POST",url:ld_propanel_settings.ajaxurl,dataType:"json",cache:!1,data:post_data})).done((function(reply_data){void 0!==reply_data.html&&(content.html(reply_data.html),jQuery("a.wpProQuiz_update",content).remove(),jQuery("a#wpProQuiz_resetUserStatistic",content).remove(),jQuery("#wpProQuiz_user_content").show(),jQuery("#wpProQuiz_loadUserData").hide(),content.find(".statistic_data").click((function(){return jQuery(this).parents("tr").next().toggle("fast"),!1})))})),jQuery("#wpProQuiz_overlay_close").click((function(){jQuery("#wpProQuiz_user_overlay").hide()}))}))}));